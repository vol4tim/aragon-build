import objectWithoutProperties from"../../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js";import _extends_1 from"../../../node_modules/@babel/runtime/helpers/extends.js";import regenerator from"../../../node_modules/@babel/runtime/regenerator/index.js";import asyncToGenerator from"../../../node_modules/@babel/runtime/helpers/asyncToGenerator.js";import toConsumableArray from"../../../node_modules/@babel/runtime/helpers/toConsumableArray.js";import classCallCheck from"../../../node_modules/@babel/runtime/helpers/classCallCheck.js";import createClass from"../../../node_modules/@babel/runtime/helpers/createClass.js";import assertThisInitialized from"../../../node_modules/@babel/runtime/helpers/assertThisInitialized.js";import inherits from"../../../node_modules/@babel/runtime/helpers/inherits.js";import possibleConstructorReturn from"../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js";import getPrototypeOf from"../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js";import defineProperty from"../../../node_modules/@babel/runtime/helpers/defineProperty.js";import _styled from"styled-components";import React,{useContext}from"react";import propTypes from"../../../node_modules/prop-types/index.js";import{animated as extendedAnimated,Transition}from"../../../node_modules/react-spring/web.js";import RootPortal from"../RootPortal/RootPortal.js";import{useViewport}from"../../providers/Viewport/Viewport.js";import{stylingProps}from"../../utils/components.js";import{useTheme}from"../../theme/Theme2.js";import{RADIUS,GU}from"../../style/constants.js";import{springs}from"../../style/springs.js";import{textStyle}from"../../style/text-styles.js";function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,o=getPrototypeOf(e);if(t){var n=getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return possibleConstructorReturn(this,r)}}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var id=0,move=function(e){return"translate3d(0,".concat(e,"px,0)")},ToastContext=React.createContext((function(){throw new Error("For Toast to work it needs to be part of a ToastHub's tree, which has to be declared at an upper level!")})),ToastHubProvider=function(e){inherits(r,e);var t=_createSuper(r);function r(){var e;classCallCheck(this,r);for(var o=arguments.length,n=new Array(o),i=0;i<o;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),defineProperty(assertThisInitialized(e),"state",{items:[],leaving:[],preLeaving:[]}),defineProperty(assertThisInitialized(e),"cancelMap",new WeakMap),defineProperty(assertThisInitialized(e),"add",(function(t){var r=e.props.threshold;e.setState((function(o){return r!==1/0&&o.leaving.slice(r-1).forEach((function(t){return e.cancel(t,!0)})),{items:[].concat(toConsumableArray(o.items),[{key:id++,msg:t}]),preLeaving:[]}}))})),defineProperty(assertThisInitialized(e),"remove",(function(t){e.setState((function(e){return{items:e.items.filter((function(e){return e.key!==t.key})),leaving:e.leaving.includes(t)?e.leaving:[t].concat(toConsumableArray(e.leaving))}}))})),defineProperty(assertThisInitialized(e),"config",(function(t,r){var o=springs.lazy;return"leave"===r?[{duration:e.props.timeout},o,o]:o})),defineProperty(assertThisInitialized(e),"cancel",(function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.cancelMap.has(t)){var o=e.cancelMap.get(t);o(),r&&o()}})),defineProperty(assertThisInitialized(e),"leave",(function(t){return function(){var r=asyncToGenerator(regenerator.mark((function r(o,n){return regenerator.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.cancelMap.set(t,n),r.next=3,o({to:{life:"0%"}});case 3:return e.setState((function(e){return{preLeaving:[].concat(toConsumableArray(e.preLeaving),[t])}})),r.next=6,o({to:{opacity:0}});case 6:return r.next=8,o({to:{height:0}},!0);case 8:e.setState((function(e){return{leaving:e.leaving.filter((function(e){return e.key!==t.key})),preLeaving:e.preLeaving.filter((function(e){return e.key!==t.key}))}}));case 9:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()})),e}return createClass(r,[{key:"render",value:function(){var e=this.props,t=e.children,r=e.showIndicator,o=e.position,n=e.top,i=e.shift,s=this.state,a=s.items,c=s.leaving,l=s.preLeaving,p=a.length>0||c.length>0,u=!(c.length===l.length&&c.length>0)&&p;return React.createElement(React.Fragment,null,React.createElement(ToastContext.Provider,{value:{itemsVisible:u,add:this.add}},t),p&&React.createElement(RootPortal,null,React.createElement(ToastList,_extends_1({config:this.config,items:a,leave:this.leave,position:o,remove:this.remove,showIndicator:r,top:n},stylingProps(this),{shift:i}))))}}]),r}(React.PureComponent);defineProperty(ToastHubProvider,"propTypes",{children:propTypes.node,position:propTypes.PropTypes.oneOf(["left","center","right"]),shift:propTypes.number,showIndicator:propTypes.bool,threshold:propTypes.number,timeout:propTypes.number,top:propTypes.bool}),defineProperty(ToastHubProvider,"defaultProps",{position:"right",showIndicator:!1,threshold:1/0,timeout:4e3,top:!1});var _StyledDiv=_styled("div").withConfig({displayName:"ToastHub___StyledDiv",componentId:"sc-1y0i8xl-0"})(["position:fixed;z-index:1000;top:",";bottom:",";left:","px;right:","px;display:flex;margin:0 auto;flex-direction:",";pointer-events:none;align-items:",";"],(function(e){return e._css}),(function(e){return e._css2}),(function(e){return e._css3}),(function(e){return e._css4}),(function(e){return e._css5}),(function(e){return e._css6})),_StyledAnimatedDiv=_styled(extendedAnimated.div).withConfig({displayName:"ToastHub___StyledAnimatedDiv",componentId:"sc-1y0i8xl-1"})(["box-sizing:border-box;position:relative;width:",";"],(function(e){return e._css7})),_StyledDiv2=_styled("div").withConfig({displayName:"ToastHub___StyledDiv2",componentId:"sc-1y0i8xl-2"})(["display:flex;align-items:center;overflow:hidden;height:","px;margin-top:",";margin-bottom:",";padding:0 ","px;",";color:",";background:",";border-radius:","px;"],(function(e){return e._css8}),(function(e){return e._css9}),(function(e){return e._css10}),(function(e){return e._css11}),(function(e){return e._css12}),(function(e){return e._css13}),(function(e){return e._css14}),RADIUS),_StyledAnimatedDiv2=_styled(extendedAnimated.div).withConfig({displayName:"ToastHub___StyledAnimatedDiv2",componentId:"sc-1y0i8xl-3"})(["position:absolute;bottom:",";left:0;width:auto;height:5px;background-image:linear-gradient( 130deg,#00b4e6,#00f0e0 );"],(function(e){return e._css15})),ToastList=React.memo((function(e){var t=e.config,r=e.items,o=e.leave,n=e.position,i=e.remove,s=e.showIndicator,a=e.top,c=e.shift,l=objectWithoutProperties(e,["config","items","leave","position","remove","showIndicator","top","shift"]),p=useTheme(),u=useViewport().below,m=u("medium")?2*GU:3*GU;return React.createElement(_StyledDiv,_extends_1({},l,{_css:a?"".concat(m,"px"):"unset",_css2:a?"unset":"".concat(m,"px"),_css3:m+(c||0),_css4:m+(c||0),_css5:a?"column-reverse":"column",_css6:u("medium")?"center":"left"===n?"flex-start":"right"===n?"flex-end":"center"}),React.createElement(Transition,{native:!0,items:r,keys:function(e){return e.key},from:{opacity:0,height:0,life:"100%",transform:move(30)},enter:{opacity:1,height:"auto",transform:move(0)},leave:o,onRest:i,config:t},(function(e){return function(t){var r=t.life,o=objectWithoutProperties(t,["life"]);return React.createElement(_StyledAnimatedDiv,{style:o,_css7:u("medium")?"100%":"42ch"},React.createElement(_StyledDiv2,{_css8:6*GU,_css9:a?"0":"".concat(1.25*GU,"px"),_css10:a?"".concat(1.25*GU,"px"):"0",_css11:2.5*GU,_css12:textStyle("body3"),_css13:p.floatingContent,_css14:p.floating.alpha(.95)},s&&React.createElement(_StyledAnimatedDiv2,{style:{right:r},_css15:a?"".concat(1.25*GU,"px"):"0"}),React.createElement("p",null,e.msg)))}})))}));ToastList.propTypes={config:propTypes.func,items:propTypes.array,leave:propTypes.func,position:propTypes.PropTypes.oneOf(["left","center","right"]),remove:propTypes.func,shift:propTypes.number,showIndicator:propTypes.bool,top:propTypes.bool};var useToast=function(){return useContext(ToastContext).add},Toast=function(e){return e.children(useToast())};export default ToastHubProvider;export{Toast,ToastContext,useToast};