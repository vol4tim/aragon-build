import defineProperty from"../../../node_modules/@babel/runtime/helpers/defineProperty.js";import slicedToArray from"../../../node_modules/@babel/runtime/helpers/slicedToArray.js";import _styled from"styled-components";import React,{useState,useCallback}from"react";import propTypes from"../../../node_modules/prop-types/index.js";import{animated as extendedAnimated,Transition}from"../../../node_modules/react-spring/web.js";import CheckBoxWithTheme from"../Input/Checkbox.js";import{ToggleButton}from"./ToggleButton.js";import{OpenedSurfaceBorder}from"./OpenedSurfaceBorder.js";import{useTheme}from"../../theme/Theme2.js";import{GU}from"../../style/constants.js";import{textStyle}from"../../style/text-styles.js";import{springs}from"../../style/springs.js";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _StyledDiv=_styled("div").withConfig({displayName:"ListView___StyledDiv",componentId:"sc-1wnrej-0"})(["position:relative;padding:0;padding-right:","px;padding-left:","px;border-bottom:","px solid ",";transition:background 150ms ease-in-out;background:",";"],(function(e){return e._css}),(function(e){return e._css2}),(function(e){return e._css3}),(function(e){return e._css4}),(function(e){return e._css5})),_StyledDiv2=_styled("div").withConfig({displayName:"ListView___StyledDiv2",componentId:"sc-1wnrej-1"})(["position:absolute;top:","px;left:0;display:flex;justify-content:center;width:","px;"],(function(e){return e._css6}),(function(e){return e._css7})),_StyledDiv3=_styled("div").withConfig({displayName:"ListView___StyledDiv3",componentId:"sc-1wnrej-2"})(["position:absolute;top:","px;right:","px;"],(function(e){return e._css8}),(function(e){return e._css9})),_StyledDiv4=_styled("div").withConfig({displayName:"ListView___StyledDiv4",componentId:"sc-1wnrej-3"})(["display:flex;flex-direction:column;padding-bottom:","px;"],(function(e){return e._css10})),_StyledDiv5=_styled("div").withConfig({displayName:"ListView___StyledDiv5",componentId:"sc-1wnrej-4"})(["display:flex;align-items:center;margin:","px 0 ","px;color:",";",";"],(function(e){return e._css11}),(function(e){return e._css12}),(function(e){return e._css13}),(function(e){return e._css14}));function ListView(e){e.allSelected;var t=e.entries,n=e.fields,r=e.hasAnyExpansion,i=e.onSelect;e.onSelectAll,e.renderSelectionCount;var s=e.selectable,o=e.rowHeight,c=useTheme(),a=useState(-1),l=slicedToArray(a,2),d=l[0],p=l[1],u=useCallback((function(e){p((function(t){return t===e?-1:e}))}),[]),f=s||r;return React.createElement(React.Fragment,null,t.map((function(e,r){var a=e.expansion.content.length>0;return React.createElement(_StyledDiv,{key:r,_css:3*GU,_css2:(f?6.5:3)*GU,_css3:Number(r!==t.length-1),_css4:c.border,_css5:e.selected?c.surfaceSelected:"none"},React.createElement(OpenedSurfaceBorder,{opened:e.index===d}),f&&React.createElement(_StyledDiv2,{_css6:1.5*GU,_css7:6.5*GU},s&&React.createElement(Select,{index:e.index,selected:e.selected,onSelect:i}),!s&&a&&React.createElement(ToggleButton,{opened:e.index===d,onClick:function(){return u(e.index)}})),e.actions&&React.createElement(_StyledDiv3,{_css8:2*GU,_css9:3*GU},e.actions),React.createElement("div",null,e.entryNodes.map((function(e,t){return[e,n[t].label,n[t].priority&&n[t].priority||0]})).sort((function(e,t){return t[2]-e[2]})).map((function(e,t,n){var r=slicedToArray(e,2),i=r[0],s=r[1];return React.createElement(_StyledDiv4,{key:t,_css10:t===n.length-1?2*GU:0},React.createElement(_StyledDiv5,{_css11:2*GU,_css12:1*GU,_css13:c.surfaceContentSecondary,_css14:textStyle("label2")},s),React.createElement("div",null,i))}))),a&&React.createElement(EntryExpansion,{expansion:e.expansion,opened:d===e.index,rowHeight:o}))})))}ListView.propTypes={allSelected:propTypes.oneOf([-1,0,1]).isRequired,entries:propTypes.array.isRequired,fields:propTypes.array.isRequired,hasAnyExpansion:propTypes.bool.isRequired,onSelect:propTypes.func.isRequired,onSelectAll:propTypes.func.isRequired,renderSelectionCount:propTypes.func.isRequired,rowHeight:propTypes.number.isRequired,selectable:propTypes.bool.isRequired};var _StyledAnimatedDiv=_styled(extendedAnimated.div).withConfig({displayName:"ListView___StyledAnimatedDiv",componentId:"sc-1wnrej-5"})(["overflow:hidden;background:",";margin-left:","px;margin-right:","px;padding-left:","px;box-shadow:inset 0 6px 4px -4px rgba(0,0,0,0.16);"],(function(e){return e._css15}),(function(e){return e._css16}),(function(e){return e._css17}),(function(e){return e._css18})),_StyledDiv6=_styled("div").withConfig({displayName:"ListView___StyledDiv6",componentId:"sc-1wnrej-6"})(["display:flex;align-items:center;height:",";padding-right:","px;"],(function(e){return e._css19}),(function(e){return e._css20}));function EntryExpansion(e){var t=e.expansion,n=e.opened,r=e.rowHeight,i=useTheme(),s=useState(0),o=slicedToArray(s,2),c=o[0],a=o[1],l=useCallback((function(e){e&&a(e.getBoundingClientRect().height)}),[]),d=t.freeLayout?c:r*t.content.length;return React.createElement(Transition,{native:!0,items:n,from:{height:0},enter:{height:d},update:{height:d},leave:{height:0},config:_objectSpread(_objectSpread({},springs.smooth),{},{precision:.1})},(function(e){return e&&function(e){var n=e.height;return React.createElement(_StyledAnimatedDiv,{style:{height:n.interpolate((function(e){return"".concat(e,"px")}))},_css15:i.surfaceUnder,_css16:-6.5*GU,_css17:-3*GU,_css18:6.5*GU},t.content.map((function(e,n){return React.createElement(_StyledDiv6,{key:n,ref:t.freeLayout?l:null,_css19:t.freeLayout?"auto":"".concat(r,"px"),_css20:3*GU},e)})))}}))}function Select(e){var t=e.index,n=e.selected,r=e.onSelect,i=useCallback((function(e){r(t,e)}),[t,r]);return React.createElement(CheckBoxWithTheme,{onChange:i,checked:n})}export{ListView};