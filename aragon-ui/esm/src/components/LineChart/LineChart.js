import _extends_1 from"../../../node_modules/@babel/runtime/helpers/extends.js";import toConsumableArray from"../../../node_modules/@babel/runtime/helpers/toConsumableArray.js";import objectWithoutProperties from"../../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js";import slicedToArray from"../../../node_modules/@babel/runtime/helpers/slicedToArray.js";import _styled from"styled-components";import React,{useMemo,useCallback,useRef,useState,useEffect}from"react";import{Spring}from"../../../node_modules/react-spring/web.js";import ExtendedPropTypes from"../../proptypes.js";import{unselectable}from"../../utils/css.js";import{springs}from"../../style/springs.js";var LABELS_HEIGHT=30,WIDTH_DEFAULT=300;function useMeasuredWidth(){var e=useRef(),t=useState(WIDTH_DEFAULT),r=slicedToArray(t,2),n=r[0],o=r[1],a=useCallback((function(){e.current&&o(e.current.clientWidth)}),[]),s=useCallback((function(t){e.current=t,a()}),[a]);return useEffect((function(){return window.addEventListener("resize",a),function(){return window.removeEventListener("resize",a)}}),[a]),[n,s]}var _StyledSvg=_styled("svg").withConfig({displayName:"LineChart___StyledSvg",componentId:"sc-8kiakb-0"})(["display:block"]),_StyledText=_styled("text").withConfig({displayName:"LineChart___StyledText",componentId:"sc-8kiakb-1"})(["alignment-baseline:middle;font-size:12px;font-weight:300;",";"],unselectable);function LineChart(e){var t=e.animDelay,r=e.borderColor,n=e.color,o=e.dotRadius,a=e.height,s=e.label,l=e.labelColor,i=e.lines,c=e.reset,d=e.springConfig,u=e.total,p=e.width,m=objectWithoutProperties(e,["animDelay","borderColor","color","dotRadius","height","label","labelColor","lines","reset","springConfig","total","width"]),y=useMeasuredWidth(),f=slicedToArray(y,2),h=f[0],b=f[1],E=useMemo((function(){return i.map((function(e){return Array.isArray(e)?{values:e}:e}))}),[i]),g=useMemo((function(){return E[0]?E[0].values.length:0}),[E]),x=useMemo((function(){return u>0&&u>g?u:g}),[g,u]),T=useCallback((function(e){return h/Math.max(1,x-1)*e}),[h,x]),C=useCallback((function(e,t,r){var n=o+2;return r-n-(r-2*n)*e*t}),[o]),k=useCallback((function(e,t){return 0===e?"start":e===t-1?"end":"middle"}),[]),_=s&&x>0?toConsumableArray(Array(x).keys()).map(s):null,P=a-(_?LABELS_HEIGHT:0),v=React.createElement("rect",{width:h,height:P,rx:"3",ry:"3",fill:"#ffffff",strokeWidth:"1",stroke:r});return React.createElement(Spring,{from:{progress:0},to:{progress:1},config:d,delay:t,reset:c},(function(e){var t=e.progress;return React.createElement(_StyledSvg,_extends_1({ref:b,viewBox:"0 0 ".concat(h," ").concat(a),width:p||"auto",height:"auto"},m),React.createElement("mask",{id:"chart-mask"},v),v,React.createElement("g",{mask:"url(#chart-mask)"},x>0&&React.createElement("path",{d:"\n                  ".concat(toConsumableArray(new Array(x-1)).reduce((function(e,t,r){return"".concat(e," M ").concat(T(r),",").concat(P," l 0,-8")}),""),"\n                "),stroke:r,strokeWidth:"1"}),E.map((function(e,r){return React.createElement("g",{key:"line-plot-".concat(e.id||r)},React.createElement("path",{d:"\n                    M\n                    ".concat(T(0),",\n                    ").concat(C(e.values[0],t,P),"\n\n                    ").concat(e.values.slice(1).map((function(e,r){return"L\n                           ".concat(T((r+1)*t),",\n                           ").concat(C(e,t,P),"\n                          ")})).join(""),"\n                  "),fill:"transparent",stroke:e.color||n(r,{lines:E}),strokeWidth:"2"}),e.values.slice(1,-1).map((function(a,s){return React.createElement("circle",{key:s,cx:T(s+1)*t,cy:C(a,t,P),r:o,fill:"white",stroke:e.color||n(r,{lines:E}),strokeWidth:"1"})})))})),React.createElement("line",{x1:T(g-1)*t,y1:"0",x2:T(g-1)*t,y2:P,stroke:"#DAEAEF",strokeWidth:"3"})),_&&React.createElement("g",{transform:"translate(0,".concat(P,")")},_.map((function(e,t){return React.createElement(_StyledText,{key:t,x:T(t),y:LABELS_HEIGHT/2,textAnchor:k(t,_.length),fill:l},e)}))))}))}LineChart.propTypes={springConfig:ExtendedPropTypes._spring,total:ExtendedPropTypes.number,width:ExtendedPropTypes.number,height:ExtendedPropTypes.number,dotRadius:ExtendedPropTypes.number,animDelay:ExtendedPropTypes.number,borderColor:ExtendedPropTypes.string,labelColor:ExtendedPropTypes.string,reset:ExtendedPropTypes.bool,lines:ExtendedPropTypes.arrayOf(ExtendedPropTypes.oneOfType([ExtendedPropTypes.shape({id:ExtendedPropTypes.number,values:ExtendedPropTypes.arrayOf(ExtendedPropTypes.number).isRequired,color:ExtendedPropTypes.string}),ExtendedPropTypes.arrayOf(ExtendedPropTypes.number)])),label:ExtendedPropTypes.oneOfType([ExtendedPropTypes.func,ExtendedPropTypes._null]),color:ExtendedPropTypes.func},LineChart.defaultProps={springConfig:springs.lazy,total:-1,height:200,dotRadius:3.5,animDelay:500,reset:!1,borderColor:"rgba(209, 209, 209, 0.5)",labelColor:"#6d777b",lines:[],label:function(e){return e+1},color:function(e,t){var r=t.lines;return"hsl(".concat((e*(360/r.length)+40)%360,", 60%, 70%)")}};export default LineChart;