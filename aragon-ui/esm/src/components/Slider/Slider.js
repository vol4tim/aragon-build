import _extends_1 from"../../../node_modules/@babel/runtime/helpers/extends.js";import objectWithoutProperties from"../../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js";import classCallCheck from"../../../node_modules/@babel/runtime/helpers/classCallCheck.js";import createClass from"../../../node_modules/@babel/runtime/helpers/createClass.js";import assertThisInitialized from"../../../node_modules/@babel/runtime/helpers/assertThisInitialized.js";import inherits from"../../../node_modules/@babel/runtime/helpers/inherits.js";import possibleConstructorReturn from"../../../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js";import getPrototypeOf from"../../../node_modules/@babel/runtime/helpers/getPrototypeOf.js";import defineProperty from"../../../node_modules/@babel/runtime/helpers/defineProperty.js";import _styled from"styled-components";import React from"react";import propTypes from"../../../node_modules/prop-types/index.js";import{animated as extendedAnimated,Spring}from"../../../node_modules/react-spring/web.js";import{useTheme}from"../../theme/Theme2.js";import{unselectable}from"../../utils/css.js";import{springs}from"../../style/springs.js";function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=getPrototypeOf(e);if(t){var o=getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return possibleConstructorReturn(this,n)}}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var BAR_HEIGHT=6,HANDLE_SIZE=24,HANDLE_SHADOW_MARGIN=15,PADDING=5,MIN_WIDTH=10*HANDLE_SIZE,HEIGHT=Math.max(HANDLE_SIZE,BAR_HEIGHT)+2*PADDING,DEFAULT_RECT="undefined"==typeof window||"function"!=typeof window.DOMRect?{x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0}:new window.DOMRect,_StyledDiv=_styled("div").withConfig({displayName:"Slider___StyledDiv",componentId:"sc-94djfe-0"})(["min-width:","px;padding:0 ","px;",";"],MIN_WIDTH,(function(e){return e._css}),unselectable),_StyledDiv2=_styled("div").withConfig({displayName:"Slider___StyledDiv2",componentId:"sc-94djfe-1"})(["position:relative;height:","px;cursor:pointer;"],HEIGHT),_StyledAnimatedDiv=_styled(extendedAnimated.div).withConfig({displayName:"Slider___StyledAnimatedDiv",componentId:"sc-94djfe-2"})(["position:absolute;top:50%;left:0;width:","px;height:","px;border:1px solid ",";border-radius:50%;cursor:pointer;pointer-events:auto;"],HANDLE_SIZE,HANDLE_SIZE,(function(e){return e._css4})),Slider=function(e){inherits(n,e);var t=_createSuper(n);function n(){var e;classCallCheck(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),defineProperty(assertThisInitialized(e),"state",{pressed:!1}),defineProperty(assertThisInitialized(e),"handleRef",(function(t){e._mainElement=t,e._document=t&&t.ownerDocument})),defineProperty(assertThisInitialized(e),"getRect",(function(){var t=Date.now();return e._lastRect&&t-e._lastRectTime<1e3||(e._lastRectTime=t,e._lastRect=e._mainElement?e._mainElement.getBoundingClientRect():DEFAULT_RECT),e._lastRect})),defineProperty(assertThisInitialized(e),"dragStart",(function(t){e.dragStop();var n=e.clientXFromEvent(t);e.setState({pressed:!0},(function(){e.updateValueFromClientX(n)})),e._document.addEventListener("mouseup",e.dragStop),e._document.addEventListener("touchend",e.dragStop),e._document.addEventListener("mousemove",e.dragMove),e._document.addEventListener("touchmove",e.dragMove)})),defineProperty(assertThisInitialized(e),"dragStop",(function(){e.setState({pressed:!1}),e._document.removeEventListener("mouseup",e.dragStop),e._document.removeEventListener("touchend",e.dragStop),e._document.removeEventListener("mousemove",e.dragMove),e._document.removeEventListener("touchmove",e.dragMove)})),defineProperty(assertThisInitialized(e),"dragMove",(function(t){e.state.pressed&&e.updateValueFromClientX(e.clientXFromEvent(t))})),e}return createClass(n,[{key:"componentWillUnmount",value:function(){this.dragStop()}},{key:"clientXFromEvent",value:function(e){return(e.touches?e.touches.item(0):e).clientX}},{key:"updateValueFromClientX",value:function(e){var t=this.getRect(),n=Math.min(t.width,Math.max(0,e-t.x));this.props.onUpdate(n/t.width)}},{key:"getHandleStyles",value:function(e){return{transform:e.interpolate((function(e){return"translate3d(0, calc(".concat(.5*e,"px - 50%), 0)")})),boxShadow:e.interpolate((function(e){return"0 1px 3px rgba(0, 0, 0, ".concat(.1-.02*e,")")})),background:e.interpolate((function(e){return"hsl(0, 0%, ".concat(100*(1-.01*e),"%)")}))}}},{key:"getHandlePositionStyles",value:function(e){return{transform:e.interpolate((function(e){return"translate3d(calc(".concat(100*e,"% + ").concat(HANDLE_SHADOW_MARGIN,"px), 0, 0)")}))}}},{key:"getActiveBarStyles",value:function(e,t){return{transform:e.interpolate((function(e){return"scaleX(".concat(e,") translateZ(0)")}))}}},{key:"render",value:function(){var e=this,t=this.state.pressed,n=this.props;n.onUpdate;var r=n.value,o=n.theme,i=objectWithoutProperties(n,["onUpdate","value","theme"]);return React.createElement(Spring,{native:!0,config:springs.swift,to:{pressProgress:Number(t),value:Math.max(0,Math.min(1,r))}},(function(t){var n=t.value,r=t.pressProgress;return React.createElement(_StyledDiv,_extends_1({},i,{_css:HANDLE_SIZE/2+PADDING}),React.createElement(_StyledDiv2,{ref:e.handleRef,onMouseDown:e.dragStart,onTouchStart:e.dragStart},React.createElement(Bars,null,React.createElement(_StyledBar,{_css2:o.surfaceUnder}),React.createElement(_StyledBar2,{style:e.getActiveBarStyles(n,r),_css3:o.selected})),React.createElement(HandleClip,null,React.createElement(HandlePosition,{style:e.getHandlePositionStyles(n,r)},React.createElement(_StyledAnimatedDiv,{style:e.getHandleStyles(r),_css4:o.border})))))}))}}]),n}(React.Component);defineProperty(Slider,"propTypes",{value:propTypes.number,onUpdate:propTypes.func,theme:propTypes.object}),defineProperty(Slider,"defaultProps",{value:0,onUpdate:function(){}});var Bars=_styled(extendedAnimated.div).withConfig({displayName:"Slider__Bars",componentId:"sc-94djfe-3"})(["position:absolute;left:0;right:0;top:50%;transform:translateY(-50%);overflow:hidden;border-radius:2px;height:","px;"],BAR_HEIGHT),Bar=_styled(extendedAnimated.div).withConfig({displayName:"Slider__Bar",componentId:"sc-94djfe-4"})(["position:absolute;top:0;left:0;right:0;bottom:0;"]),_StyledBar2=_styled(Bar).withConfig({displayName:"Slider___StyledBar2",componentId:"sc-94djfe-5"})(["transform-origin:0 0;background:",";"],(function(e){return e._css3})),_StyledBar=_styled(Bar).withConfig({displayName:"Slider___StyledBar",componentId:"sc-94djfe-6"})(["background:",";"],(function(e){return e._css2})),HandleClip=_styled.div.withConfig({displayName:"Slider__HandleClip",componentId:"sc-94djfe-7"})(["pointer-events:none;overflow:hidden;width:calc(100% + ","px);height:calc(100% + ","px);transform-origin:50% 50%;transform:translate( -","px,-","px );"],HANDLE_SIZE+2*HANDLE_SHADOW_MARGIN,2*HANDLE_SHADOW_MARGIN,HANDLE_SIZE/2+HANDLE_SHADOW_MARGIN,HANDLE_SHADOW_MARGIN),HandlePosition=_styled(extendedAnimated.div).withConfig({displayName:"Slider__HandlePosition",componentId:"sc-94djfe-8"})(["width:calc(100% - ","px);height:100%;transform-origin:50% 50%;"],HANDLE_SIZE+2*HANDLE_SHADOW_MARGIN),Slider$1=function(e){var t=useTheme();return React.createElement(Slider,_extends_1({theme:t},e))};export default Slider$1;