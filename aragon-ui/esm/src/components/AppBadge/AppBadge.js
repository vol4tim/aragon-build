import _extends_1 from"../../../node_modules/@babel/runtime/helpers/extends.js";import slicedToArray from"../../../node_modules/@babel/runtime/helpers/slicedToArray.js";import objectWithoutProperties from"../../../node_modules/@babel/runtime/helpers/objectWithoutProperties.js";import _styled from"styled-components";import React,{useRef,useState,useCallback}from"react";import propTypes from"../../../node_modules/prop-types/index.js";import BadgeBase from"../BadgeBase/BadgeBase.js";import BadgePopoverActionType from"../BadgeBase/BadgePopoverActionType.js";import Tag from"../Tag/Tag.js";import AppBadgePopover from"./AppBadgePopover.js";import iconDefaultSvg from"./assets/app-default.svg.js";import{isAddress}from"../../utils/web3.js";import{warn}from"../../utils/environment.js";import{ImageExists}from"../../hooks/useImageExists.js";import{GU,RADIUS}from"../../style/constants.js";var _StyledDiv=_styled("div").withConfig({displayName:"AppBadge___StyledDiv",componentId:"sc-5gkmrm-0"})(["display:grid;align-items:center;grid-template-columns:auto 1fr;"]),_StyledSpan=_styled("span").withConfig({displayName:"AppBadge___StyledSpan",componentId:"sc-5gkmrm-1"})(["display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;"]),_StyledTag=_styled(Tag).withConfig({displayName:"AppBadge___StyledTag",componentId:"sc-5gkmrm-2"})(["margin-left:","px;"],(function(e){return e._css})),AppBadge=React.memo((function(e){var t=e.appAddress,o=e.badgeOnly,r=e.compact,p=e.iconSrc,s=e.identifier,a=e.label,n=e.labelStyle,i=e.networkType,c=e.popoverAction,l=e.popoverTitle;objectWithoutProperties(e,["appAddress","badgeOnly","compact","iconSrc","identifier","label","labelStyle","networkType","popoverAction","popoverTitle"]);var d=useRef(null),m=useState(!1),g=slicedToArray(m,2),u=g[0],y=g[1],f=useCallback((function(){return y(!1)}),[]),_=useCallback((function(){return y(!0)}),[]),b=isAddress(t);return o||b||warn("AppBadge: provided invalid app address (".concat(t,")")),l=l||React.createElement(_StyledDiv,null,React.createElement(_StyledSpan,null,a),s&&React.createElement(_StyledTag,{mode:"identifier",_css:1*GU},s)),React.createElement(BadgeBase,{badgeRef:d,compact:r,disabled:o,icon:React.createElement(ImageExists,{src:p},(function(e){e.displayFallback;var t=e.exists;return React.createElement(Icon,{compact:r,src:t?p:iconDefaultSvg})})),label:a,labelStyle:n,onClick:b?_:void 0,title:t},(function(e){return!e&&t&&React.createElement(AppBadgePopover,{appAddress:t,iconFallbackSrc:iconDefaultSvg,iconSrc:p,networkType:i,onClose:f,opener:d.current,popoverAction:c,title:l,visible:u})}))}));AppBadge.propTypes={appAddress:propTypes.string,badgeOnly:propTypes.bool,compact:propTypes.bool,iconSrc:propTypes.string,identifier:propTypes.string,label:propTypes.string.isRequired,labelStyle:propTypes.string,networkType:propTypes.string,popoverAction:BadgePopoverActionType,popoverTitle:propTypes.node};var _StyledSpan2=_styled("span").withConfig({displayName:"AppBadge___StyledSpan2",componentId:"sc-5gkmrm-3"})(["flex-shrink:0;width:","px;height:","px;margin-right:","px;border-radius:",";background-size:contain;background-position:50% 50%;background-repeat:no-repeat;background-image:url(",");"],(function(e){return e._css2}),(function(e){return e._css3}),(function(e){return e._css4}),(function(e){return e._css5}),(function(e){return e._css6})),Icon=function(e){var t=e.compact,o=e.src,r=objectWithoutProperties(e,["compact","src"]),p=(t?2.25:3)*GU;return React.createElement(_StyledSpan2,_extends_1({},r,{_css2:p,_css3:p,_css4:1*GU,_css5:t?"".concat(RADIUS,"px"):0,_css6:o}))};Icon.propTypes={compact:propTypes.bool,src:propTypes.string.isRequired};export default AppBadge;