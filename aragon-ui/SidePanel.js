"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=require("./extends-023d783e.js"),objectWithoutProperties=require("./objectWithoutProperties-c6d3675c.js"),defineProperty=require("./defineProperty-3cad0327.js"),slicedToArray=require("./slicedToArray-a8a77f0e.js"),_styled=require("styled-components"),React=require("react"),index$1=require("./index-37353731.js"),web=require("./web-46d746d6.js"),index=require("./index-c33eeeef.js"),ButtonIcon=require("./ButtonIcon.js"),Viewport=require("./Viewport-71f7efe6.js"),RootPortal=require("./RootPortal.js"),Theme=require("./Theme.js"),IconCross=require("./IconCross.js"),keycodes=require("./keycodes.js"),springs=require("./springs.js"),constants=require("./constants.js"),css=require("./css.js"),textStyles=require("./text-styles.js"),environment=require("./environment.js");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("./_commonjsHelpers-1b94f6bc.js"),require("./unsupportedIterableToArray-f175acfa.js"),require("./objectWithoutPropertiesLoose-1af20ad0.js"),require("react-dom"),require("./Button.js"),require("./Layout.js"),require("./breakpoints.js"),require("./getPrototypeOf-55c9e80c.js"),require("./_baseGetTag-6ec23aaa.js"),require("./ButtonBase.js"),require("./FocusVisible.js"),require("./theme-dark.js"),require("./theme-light.js"),require("./color.js"),require("./toConsumableArray-cc0d28a9.js"),require("./miscellaneous.js"),require("./font.js"),require("./Root-07f851a6.js"),require("./IconPropTypes-b9997416.js");var _styled__default=_interopDefaultLegacy(_styled),React__default=_interopDefaultLegacy(React);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){defineProperty.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var CONTENT_PADDING=3*constants.GU,CLOSING_POSITION=5*constants.GU,SidePanelContext=React__default.default.createContext(null),_StyledDiv=_styled__default.default("div").withConfig({displayName:"SidePanel___StyledDiv",componentId:"sc-1kjx6mk-0"})(["position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;pointer-events:",";overflow:hidden;"],(function(e){return e._css})),_StyledAnimatedDiv=_styled__default.default(web.extendedAnimated.div).withConfig({displayName:"SidePanel___StyledAnimatedDiv",componentId:"sc-1kjx6mk-1"})(["position:absolute;top:0;left:0;right:0;bottom:0;background:",";"],(function(e){return e._css2})),_StyledHeader=_styled__default.default("header").withConfig({displayName:"SidePanel___StyledHeader",componentId:"sc-1kjx6mk-2"})(["display:flex;flex-direction:column;justify-content:center;flex-shrink:0;position:relative;height:","px;padding-left:","px;border-bottom:1px solid ",";",";"],(function(e){return e._css3}),CONTENT_PADDING,(function(e){return e._css4}),(function(e){return e._css5})),_StyledH=_styled__default.default("h1").withConfig({displayName:"SidePanel___StyledH",componentId:"sc-1kjx6mk-3"})(["color:",";",";"],(function(e){return e._css6}),(function(e){return e._css7})),_StyledButtonIcon=_styled__default.default(ButtonIcon.default).withConfig({displayName:"SidePanel___StyledButtonIcon",componentId:"sc-1kjx6mk-4"})(["position:absolute;",""],(function(e){return e._css8})),_StyledDiv2=_styled__default.default("div").withConfig({displayName:"SidePanel___StyledDiv2",componentId:"sc-1kjx6mk-5"})(["overflow-y:auto;height:100%;display:flex;flex-direction:column;"]),_StyledDiv3=_styled__default.default("div").withConfig({displayName:"SidePanel___StyledDiv3",componentId:"sc-1kjx6mk-6"})(["min-height:0;flex-grow:1;flex-shrink:0;display:flex;flex-direction:column;width:100%;padding-right:","px;padding-left:","px;padding-bottom:","px;"],CONTENT_PADDING,CONTENT_PADDING,CONTENT_PADDING);function SidePanel(e){var t=e.blocking,n=e.children,o=e.opened,r=e.onClose,a=e.onTransitionEnd,s=e.title,i=Theme.useTheme(),c=(0,Viewport.useViewport().below)("medium"),d=React.useCallback((function(){t||r()}),[t,r]),l=React.useCallback((function(e){e.keyCode===keycodes.KEY_ESC&&o&&d()}),[o,d]),u=React.useState(o?"opened":"closed"),f=slicedToArray.slicedToArray(u,2),p=f[0],_=f[1],y=React.useState(!1),m=slicedToArray.slicedToArray(y,2),b=m[0],x=m[1],j=React.useCallback((function(){a(o),_(o?"opened":"closed")}),[o,a]),S=React.useCallback((function(){_(o?"opening":"closing")}),[o]),P=React.useCallback((function(e,t,n){var o=n.progress;o>.5&&!b?x(!0):o<.5&&b&&x(!1)}),[b]),h=React.useCallback((function(){x(!1)}),[]);return React.useEffect((function(){return document.addEventListener("keydown",l),function(){document.removeEventListener("keydown",l)}}),[l]),React__default.default.createElement(RootPortal.default,null,React__default.default.createElement(index.i,{name:"SidePanel"},React__default.default.createElement(web.Transition,{items:o,config:_objectSpread(_objectSpread({},springs.springs.lazy),{},{precision:.001}),from:{progress:0},enter:{progress:Number(o)},leave:{progress:0},onRest:j,onStart:S,onFrame:P,onDestroyed:h,unique:!0,native:!0},(function(e){return e&&function(e){var o=e.progress;return React__default.default.createElement(_StyledDiv,{_css:"closing"!==p?"auto":"none"},React__default.default.createElement(_StyledAnimatedDiv,{onClick:d,style:{opacity:o,pointerEvents:"closing"!==p?"auto":"none"},_css2:i.overlay.alpha(.9)}),React__default.default.createElement(Panel,{compact:c,style:{transform:o.interpolate((function(e){return"\n                          translate3d(\n                            calc(\n                              ".concat(100*(1-e),"% +\n                              ").concat(CLOSING_POSITION*(1-e),"px\n                            ), 0, 0\n                          )\n                        ")}))}},React__default.default.createElement(_StyledHeader,{_css3:8*constants.GU,_css4:i.border,_css5:css.unselectable()},React__default.default.createElement(_StyledH,{_css6:i.surfaceContent,_css7:textStyles.textStyle("body1")},s),!t&&React__default.default.createElement(_StyledButtonIcon,{label:"Close",onClick:d,_css8:c?"\n                              top: 0;\n                              right: 0;\n                              height: ".concat(8*constants.GU,"px;\n                              width: ").concat(8*constants.GU,"px;\n                            "):"\n                              top: ".concat(2*constants.GU,"px;\n                              right: ").concat(2*constants.GU,"px;\n                            ")},React__default.default.createElement(IconCross.default,{color:i.surfaceIcon}))),React__default.default.createElement(_StyledDiv2,null,React__default.default.createElement(_StyledDiv3,null,React__default.default.createElement(SidePanelContext.Provider,{value:{status:p,readyToFocus:b}},n)))))}}))))}SidePanel.propTypes={blocking:index$1.propTypes.bool,children:index$1.propTypes.node.isRequired,opened:index$1.propTypes.bool,onClose:index$1.propTypes.func,onTransitionEnd:index$1.propTypes.func,title:index$1.propTypes.node.isRequired},SidePanel.defaultProps={opened:!0,blocking:!1,onClose:function(){},onTransitionEnd:function(){}};var _StyledAnimatedAside=_styled__default.default(web.extendedAnimated.aside).withConfig({displayName:"SidePanel___StyledAnimatedAside",componentId:"sc-1kjx6mk-7"})(["position:absolute;top:0;right:0;display:flex;flex-direction:column;width:100%;height:100%;background:",";box-shadow:-2px 0px 4px rgba(0,0,0,0.1);",""],(function(e){return e._css9}),(function(e){return e._css10})),Panel=React__default.default.memo((function(e){var t=e.compact,n=objectWithoutProperties.objectWithoutProperties(e,["compact"]),o=Theme.useTheme();return React__default.default.createElement(_StyledAnimatedAside,_extends._extends_1({},n,{_css9:o.surface,_css10:t?"":"max-width: 450px;"}))}));function useSidePanel(){var e=React.useContext(SidePanelContext);if(null===e)throw new Error("useSidePanel() was used outside of the SidePanel render tree, which has to be declared at an upper level!");return e}function useSidePanelFocusOnReady(e){var t=useSidePanel().readyToFocus,n=React.useRef(),o=e||n;return React.useEffect((function(){t&&o.current&&(o.current.focus?o.current.focus():environment.warn("useSidePanelFocusOnReady(): the focus() method wasnâ€™t available on the passed ref."))}),[t,o]),o}Panel.propTypes={compact:index$1.propTypes.bool},SidePanel.HORIZONTAL_PADDING=CONTENT_PADDING,exports.default=SidePanel,exports.useSidePanel=useSidePanel,exports.useSidePanelFocusOnReady=useSidePanelFocusOnReady;