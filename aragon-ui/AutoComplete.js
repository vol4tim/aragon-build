"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=require("./extends-023d783e.js"),slicedToArray=require("./slicedToArray-a8a77f0e.js"),_styled=require("styled-components"),React=require("react"),index=require("./index-37353731.js"),web=require("./web-46d746d6.js"),ButtonBase=require("./ButtonBase.js"),SearchInput=require("./SearchInput.js"),useArrowKeysFocus=require("./useArrowKeysFocus.js"),useClickOutside=require("./useClickOutside.js"),useKeyDown=require("./useKeyDown.js"),Theme=require("./Theme.js"),miscellaneous=require("./miscellaneous.js"),useFocusLeave=require("./useFocusLeave.js"),keycodes=require("./keycodes.js"),springs=require("./springs.js"),css=require("./css.js");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("./_commonjsHelpers-1b94f6bc.js"),require("./unsupportedIterableToArray-f175acfa.js"),require("./objectWithoutPropertiesLoose-1af20ad0.js"),require("react-dom"),require("./objectWithoutProperties-c6d3675c.js"),require("./defineProperty-3cad0327.js"),require("./FocusVisible.js"),require("./getPrototypeOf-55c9e80c.js"),require("./constants.js"),require("./environment.js"),require("./text-styles.js"),require("./font.js"),require("./theme-dark.js"),require("./theme-light.js"),require("./color.js"),require("./toConsumableArray-cc0d28a9.js"),require("./ButtonIcon.js"),require("./Button.js"),require("./index-c33eeeef.js"),require("./Layout.js"),require("./Viewport-71f7efe6.js"),require("./_baseGetTag-6ec23aaa.js"),require("./breakpoints.js"),require("./TextInput.js"),require("./IconSearch.js"),require("./IconPropTypes-b9997416.js"),require("./IconCross.js");var _styled__default=_interopDefaultLegacy(_styled),React__default=_interopDefaultLegacy(React),_StyledDiv=_styled__default.default("div").withConfig({displayName:"AutoComplete___StyledDiv",componentId:"bpnxyo-0"})(["position:relative"]);function AutoComplete(e){var t=e.forwardedRef,r=e.itemButtonStyles,o=void 0===r?"":r,s=e.items,u=void 0===s?[]:s,n=e.onSelect,i=void 0===n?miscellaneous.noop:n,a=e.onChange,l=void 0===a?miscellaneous.noop:a,c=e.placeholder,d=e.renderItem,p=void 0===d?miscellaneous.identity:d,f=e.required,_=e.value,y=e.wide,m=t,q=new Set(u),x=React.useState(!0),b=slicedToArray.slicedToArray(x,2),h=b[0],j=b[1],g=React.useRef(),R=React.useRef([]),v=React.useCallback((function(){return j(!1)}),[]),C=React.useCallback((function(){return j(!0)}),[]),w=React.useCallback((function(e){i(e),j(!1)}),[i]),S=React.useCallback((function(){j(!0),l.apply(void 0,arguments)}),[l]),A=useFocusLeave.useFocusLeave(v,g).handleFocusLeave,T=useArrowKeysFocus.useArrowKeysFocus(R),I=T.highlightedIndex,k=T.setHighlightedIndex;return useClickOutside.useClickOutside(v,g),useKeyDown.useKeyDown(keycodes.KEY_ESC,v),React.useEffect((function(){k(-1)}),[h,u,_,k]),React__default.default.createElement(_StyledDiv,{ref:g,onBlur:A},React__default.default.createElement(SearchInput.default,{ref:m,wide:y,placeholder:c,required:f,onChange:S,onFocus:C,value:_}),React__default.default.createElement(web.Transition,{config:springs.springs.swift,items:h&&u.length>0,from:{scale:.98,opacity:0},enter:{scale:1,opacity:1},leave:{scale:1,opacity:0},native:!0},(function(e){return e&&function(e){var t=e.scale,r=e.opacity;return React__default.default.createElement(Items,{style:{opacity:r,transform:t.interpolate((function(e){return"scale3d(".concat(e,",").concat(e,",1)")}))}},Array.from(q).map((function(e,t){return React__default.default.createElement(Item,{key:e.key||e,ref:function(e){return R.current[t]=e},index:t,item:e,itemButtonStyles:o,onHighlight:k,onSelect:w,selected:t===I},p(e,_))})))}})))}AutoComplete.propTypes={forwardedRef:index.propTypes.object,itemButtonStyles:index.propTypes.string,items:index.propTypes.array.isRequired,onSelect:index.propTypes.func.isRequired,onChange:index.propTypes.func.isRequired,placeholder:index.propTypes.string,renderItem:index.propTypes.func,required:index.propTypes.bool,value:index.propTypes.string,wide:index.propTypes.bool};var _StyledLi=_styled__default.default("li").withConfig({displayName:"AutoComplete___StyledLi",componentId:"bpnxyo-1"})(["overflow:hidden;cursor:pointer;",";"],(function(e){return e._css})),_StyledButtonBase=_styled__default.default(ButtonBase.default).withConfig({displayName:"AutoComplete___StyledButtonBase",componentId:"bpnxyo-2"})(["text-align:left;padding:4px 8px;width:100%;border-radius:0;border-left:3px solid transparent;cursor:pointer;",";",";"],(function(e){return e._css2}),(function(e){return e._css3})),Item=React__default.default.forwardRef((function(e,t){var r=e.children,o=e.index,s=e.item,u=e.itemButtonStyles,n=e.onHighlight,i=e.onSelect,a=e.selected,l=Theme.useTheme(),c=React.useCallback((function(e){e.preventDefault(),i(s)}),[s,i]),d=React.useCallback((function(){n(o)}),[o,n]);return React__default.default.createElement(_StyledLi,{role:"option",_css:css.unselectable()},React__default.default.createElement(_StyledButtonBase,{ref:t,onClick:c,onFocus:d,onMouseOver:d,_css2:a?"\n                outline: 2px solid ".concat(l.accent,";\n                background: ").concat(l.surfaceHighlight,";\n                border-left: 3px solid ").concat(l.accent,";\n              "):"",_css3:u},r))})),_StyledAnimatedUl=_styled__default.default(web.extendedAnimated.ul).withConfig({displayName:"AutoComplete___StyledAnimatedUl",componentId:"bpnxyo-3"})(["position:absolute;z-index:2;top:100%;width:100%;padding:8px 0;color:",";background:",";border:1px solid ",";box-shadow:0 4px 4px 0 rgba(0,0,0,0.06);border-radius:3px;padding:0;margin:0;list-style:none;& > li:first-child{border-top-left-radius:3px;border-top-right-radius:3px;}& > li:last-child{border-bottom-left-radius:3px;border-bottom-right-radius:3px;}"],(function(e){return e._css4}),(function(e){return e._css5}),(function(e){return e._css6})),Items=function(e){var t=Theme.useTheme();return React__default.default.createElement(_StyledAnimatedUl,_extends._extends_1({role:"listbox"},e,{_css4:t.surfaceContent,_css5:t.surface,_css6:t.border}))},AutoCompleteMemo=React__default.default.memo(AutoComplete),AutoComplete$1=React__default.default.forwardRef((function(e,t){return React__default.default.createElement(AutoCompleteMemo,_extends._extends_1({},e,{forwardedRef:t}))}));exports.default=AutoComplete$1;