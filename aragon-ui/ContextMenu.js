"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var slicedToArray=require("./slicedToArray-a8a77f0e.js"),_styled=require("styled-components"),React=require("react"),index=require("./index-37353731.js"),web=require("./web-46d746d6.js"),ReactDOM=require("react-dom"),ButtonBase=require("./ButtonBase.js"),IconEllipsis=require("./IconEllipsis.js"),IconDown=require("./IconDown.js"),Theme=require("./Theme.js"),springs=require("./springs.js"),constants=require("./constants.js");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("./unsupportedIterableToArray-f175acfa.js"),require("./_commonjsHelpers-1b94f6bc.js"),require("./objectWithoutPropertiesLoose-1af20ad0.js"),require("./extends-023d783e.js"),require("./objectWithoutProperties-c6d3675c.js"),require("./defineProperty-3cad0327.js"),require("./FocusVisible.js"),require("./getPrototypeOf-55c9e80c.js"),require("./keycodes.js"),require("./css.js"),require("./environment.js"),require("./miscellaneous.js"),require("./text-styles.js"),require("./font.js"),require("./theme-dark.js"),require("./theme-light.js"),require("./color.js"),require("./toConsumableArray-cc0d28a9.js"),require("./IconPropTypes-b9997416.js"),require("./index-c33eeeef.js");var _styled__default=_interopDefaultLegacy(_styled),React__default=_interopDefaultLegacy(React),ReactDOM__default=_interopDefaultLegacy(ReactDOM),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ClickOutComponent=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return _inherits(t,React__default.default.Component),_createClass(t,[{key:"componentDidMount",value:function(){var e=this,t=!0,n=!0,o=ReactDOM__default.default.findDOMNode(this);e.__documentTouchStarted=function(t){o.removeEventListener("click",e.__elementClicked),document.removeEventListener("click",e.__documentClicked)},e.__documentTouchMoved=function(e){n=!1},e.__documentTouchEnded=function(t){n&&e.__documentClicked(t),n=!0},e.__documentClicked=function(t){if(-1===(t.__clickedElements||[]).indexOf(o)){var n=e.onClickOut||e.props.onClickOut;if(!n)return console.warn("onClickOut is not defined.");n.call(e,t)}},e.__elementTouchMoved=function(e){t=!1},e.__elementTouchEnded=function(n){t&&e.__elementClicked(n),t=!0},e.__elementClicked=function(e){e.__clickedElements=e.__clickedElements||[],e.__clickedElements.push(o)},setTimeout((function(){e.__unmounted||e.toggleListeners("addEventListener")}),0)}},{key:"toggleListeners",value:function(e){var t=ReactDOM__default.default.findDOMNode(this);t[e]("touchmove",this.__elementTouchMoved),t[e]("touchend",this.__elementTouchEnded),t[e]("click",this.__elementClicked),document[e]("touchstart",this.__documentTouchStarted),document[e]("touchmove",this.__documentTouchMoved),document[e]("touchend",this.__documentTouchEnded),document[e]("click",this.__documentClicked)}},{key:"componentWillUnmount",value:function(){this.toggleListeners("removeEventListener"),this.__unmounted=!0}},{key:"render",value:function(){return Array.isArray(this.props.children)?React__default.default.createElement("div",null,this.props.children):React__default.default.Children.only(this.props.children)}}]),t}(),reactOnclickout=ClickOutComponent,BASE_WIDTH=46,BASE_HEIGHT=32,_StyledIconEllipsis=_styled__default.default(IconEllipsis.default).withConfig({displayName:"ContextMenu___StyledIconEllipsis",componentId:"ris724-0"})([""]),_StyledIconDown=_styled__default.default(IconDown.default).withConfig({displayName:"ContextMenu___StyledIconDown",componentId:"ris724-1"})(["color:",";"],(function(e){return e._css7})),_StyledAnimatedDiv=_styled__default.default(web.extendedAnimated.div).withConfig({displayName:"ContextMenu___StyledAnimatedDiv",componentId:"ris724-2"})(["z-index:",";overflow:hidden;position:absolute;top:","px;right:0;background:",";border:1px solid ",";border-radius:3px 0 3px 3px;"],(function(e){return e._css8}),(function(e){return e._css9}),(function(e){return e._css10}),(function(e){return e._css11})),_StyledDiv=_styled__default.default("div").withConfig({displayName:"ContextMenu___StyledDiv",componentId:"ris724-3"})(["z-index:",";position:absolute;bottom:0;right:1px;height:1px;width:","px;background:",";"],(function(e){return e._css12}),(function(e){return e._css13}),(function(e){return e._css14}));function ContextMenu(e){var t=e.children,n=e.zIndex,o=e.disabled,r=Theme.useTheme(),c=React.useState(!1),i=slicedToArray.slicedToArray(c,2),s=i[0],u=i[1],a=React.useCallback((function(){u(!1)}),[]),d=React.useCallback((function(){u((function(e){return!e}))}),[]),l=s?n+1:n;return React__default.default.createElement(reactOnclickout,{onClickOut:a},React__default.default.createElement(web.Spring,{config:springs.springs.smooth,to:{openProgress:Number(s)},native:!0},(function(e){var n=e.openProgress;return React__default.default.createElement(_StyledMain,{style:{boxShadow:n.interpolate((function(e){return"0 4px 4px rgba(0, 0, 0, ".concat(.03*e,")")}))},_css:l},React__default.default.createElement(_StyledButton,{onClick:d,opened:s,disabled:o,focusRingRadius:constants.RADIUS,_css2:o?r.disabledContent:s?r.accent:r.surfaceContent,_css3:o?r.disabled:r.surface,_css4:o?"0":"1px solid ".concat(r.border),_css5:s?r.surface:r.border,_css6:o?"":"&:active {\n                  background: ".concat(r.surfacePressed,";\n                  border-bottom-color: ").concat(s?r.surfacePressed:r.border,";\n                }")},React__default.default.createElement(_StyledIconEllipsis,null),React__default.default.createElement(web.extendedAnimated.div,{style:{display:"flex",alignItems:"center",transformOrigin:"50% 50%",transform:n.interpolate((function(e){return"rotate(".concat(180*e,"deg)")}))}},React__default.default.createElement(_StyledIconDown,{size:"tiny",_css7:o?r.disabledIcon:r.surfaceIcon}))),s&&React__default.default.createElement(React__default.default.Fragment,null,React__default.default.createElement(_StyledAnimatedDiv,{onClick:a,style:{opacity:n,boxShadow:n.interpolate((function(e){return"0 4px 4px rgba(0, 0, 0, ".concat(.03*e,")")}))},_css8:l+1,_css9:BASE_HEIGHT-1,_css10:r.surface,_css11:r.border},t),React__default.default.createElement(_StyledDiv,{_css12:l+1,_css13:BASE_WIDTH-2,_css14:r.surface})))})))}ContextMenu.propTypes={children:index.propTypes.node,zIndex:index.propTypes.number,disabled:index.propTypes.bool},ContextMenu.defaultProps={zIndex:0,disabled:!1};var Main=_styled__default.default(web.extendedAnimated.div).withConfig({displayName:"ContextMenu__Main",componentId:"ris724-4"})(["position:relative;width:","px;height:","px;"],BASE_WIDTH,BASE_HEIGHT),_StyledMain=_styled__default.default(Main).withConfig({displayName:"ContextMenu___StyledMain",componentId:"ris724-5"})(["z-index:",";"],(function(e){return e._css})),Button=_styled__default.default(ButtonBase.default).withConfig({displayName:"ContextMenu__Button",componentId:"ris724-6"})(["display:flex;justify-content:center;align-items:center;width:100%;height:","px;border-radius:",";box-shadow:",";"],BASE_HEIGHT,(function(e){return e.opened?"".concat(constants.RADIUS,"px ").concat(constants.RADIUS,"px 0 0"):"".concat(constants.RADIUS,"px")}),(function(e){return e.disabled?"none":"0px 1px 3px rgba(0, 0, 0, 0.1)"})),_StyledButton=_styled__default.default(Button).withConfig({displayName:"ContextMenu___StyledButton",componentId:"ris724-7"})(["color:",";background:",";border:",";border-bottom-color:",";",""],(function(e){return e._css2}),(function(e){return e._css3}),(function(e){return e._css4}),(function(e){return e._css5}),(function(e){return e._css6}));exports.default=ContextMenu;