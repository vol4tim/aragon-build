"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=require("./extends-023d783e.js"),slicedToArray=require("./slicedToArray-a8a77f0e.js"),_styled=require("styled-components"),React=require("react"),index=require("./index-37353731.js"),dayjs_min=require("./dayjs.min-ac79806e.js"),Button=require("./Button.js"),Viewport=require("./Viewport-71f7efe6.js"),DatePicker=require("./DatePicker.js"),Labels=require("./Labels.js"),consts=require("./consts.js"),utils=require("./utils.js"),Popover=require("./Popover.js"),Theme=require("./Theme.js"),constants=require("./constants.js");function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("./_commonjsHelpers-1b94f6bc.js"),require("./unsupportedIterableToArray-f175acfa.js"),require("./objectWithoutProperties-c6d3675c.js"),require("./index-c33eeeef.js"),require("./Layout.js"),require("./defineProperty-3cad0327.js"),require("./css.js"),require("./breakpoints.js"),require("./ButtonBase.js"),require("./FocusVisible.js"),require("./getPrototypeOf-55c9e80c.js"),require("./keycodes.js"),require("./environment.js"),require("./miscellaneous.js"),require("./text-styles.js"),require("./font.js"),require("./theme-dark.js"),require("./theme-light.js"),require("./color.js"),require("./toConsumableArray-cc0d28a9.js"),require("./_baseGetTag-6ec23aaa.js"),require("./MonthDay-fdf848ef.js"),require("./IconLeft.js"),require("./IconPropTypes-b9997416.js"),require("./IconRight.js"),require("./date.js"),require("./IconCalendar.js"),require("./proptypes-316e1def.js"),require("./web-46d746d6.js"),require("./objectWithoutPropertiesLoose-1af20ad0.js"),require("react-dom"),require("./RootPortal.js"),require("./Root-07f851a6.js"),require("./springs.js"),require("./components.js");var _styled__default=_interopDefaultLegacy(_styled),React__default=_interopDefaultLegacy(React),_StyledPopover=_styled__default.default(Popover.default).withConfig({displayName:"DateRangePicker___StyledPopover",componentId:"s3s5m9-0"})(["min-width:","px;border:0;filter:none;background:none;margin:2px 0 0 0;"],(function(e){return e._css})),_StyledDiv=_styled__default.default("div").withConfig({displayName:"DateRangePicker___StyledDiv",componentId:"s3s5m9-1"})(["padding:","px ","px ","px;border:1px solid ",";border-radius:","px;background:",";"],(function(e){return e._css2}),(function(e){return e._css3}),(function(e){return e._css4}),(function(e){return e._css5}),constants.RADIUS,(function(e){return e._css6})),_StyledDiv2=_styled__default.default("div").withConfig({displayName:"DateRangePicker___StyledDiv2",componentId:"s3s5m9-2"})(["display:flex;flex-direction:row;align-items:baseline;"]),_StyledDatePicker=_styled__default.default(DatePicker.default).withConfig({displayName:"DateRangePicker___StyledDatePicker",componentId:"s3s5m9-3"})(["margin-left:","px;"],(function(e){return e._css7})),_StyledDiv3=_styled__default.default("div").withConfig({displayName:"DateRangePicker___StyledDiv3",componentId:"s3s5m9-4"})(["display:flex;align-items:center;justify-content:space-between;margin-top:","px;",";"],(function(e){return e._css8}),(function(e){return e._css9})),_StyledButton=_styled__default.default(Button.default).withConfig({displayName:"DateRangePicker___StyledButton",componentId:"s3s5m9-5"})(["margin-left:","px;"],(function(e){return e._css10}));function DateRangePicker(e){var t=e.format,a=e.endDate,r=e.onChange,s=e.startDate,n=Theme.useTheme(),i=React.useRef(),o=React.useState(!1),d=slicedToArray.slicedToArray(o,2),u=d[0],c=d[1],l=React.useState(s),_=slicedToArray.slicedToArray(l,2),f=_[0],m=_[1],y=React.useState(a),p=slicedToArray.slicedToArray(y,2),j=p[0],D=p[1];React.useEffect((function(){u||(m(s),D(a))}),[a,s,u]);var q=React.useCallback((function(){return c(!1)}),[]),R=React.useCallback((function(){c((function(e){return!e}))}),[]),g=React.useCallback((function(e){var t=utils.handleDateSelect({date:e,startDate:f,endDate:j});void 0!==t.startDate&&m(t.startDate),void 0!==t.endDate&&D(t.endDate)}),[f,j]),b=React.useCallback((function(){c(!1),f&&j&&r({start:dayjs_min.dayjs_min(f).startOf("day").toDate(),end:dayjs_min.dayjs_min(j).endOf("day").toDate()})}),[j,r,f]),v=React.useCallback((function(){m(null),D(null),c(!1),r({start:null,end:null})}),[r]),x=React.useMemo((function(){var e=u?f:s,r=u?j:a;return{startText:e?dayjs_min.dayjs_min(e).format(t):consts.START_DATE,endText:r?dayjs_min.dayjs_min(r).format(t):consts.END_DATE}}),[j,a,t,u,f,s]),P=Viewport.useViewport().below("medium"),k=React.useMemo((function(){var e=s&&a&&dayjs_min.dayjs_min(s).isSame(dayjs_min.dayjs_min(a),"month");return!P&&(e||!s)}),[P,a,s]);return React__default.default.createElement("div",null,React__default.default.createElement(Labels.default,_extends._extends_1({ref:i,enabled:u,hasSetDates:Boolean(s&&a),onClick:R},x)),React__default.default.createElement(_StyledPopover,{closeOnOpenerFocus:!0,onClose:q,opener:i.current,placement:"bottom-start",visible:u,_css:37.5*constants.GU+2},React__default.default.createElement(_StyledDiv,{_css2:2.5*constants.GU,_css3:3*constants.GU,_css4:3*constants.GU,_css5:n.border,_css6:n.surface},React__default.default.createElement(_StyledDiv2,null,React__default.default.createElement(DatePicker.default,{datesRangeEnd:j,datesRangeStart:f,initialDate:dayjs_min.dayjs_min(s||void 0).subtract(k?1:0,"month").toDate(),onSelect:g}),!P&&React__default.default.createElement(_StyledDatePicker,{datesRangeEnd:j,datesRangeStart:f,initialDate:dayjs_min.dayjs_min(a||void 0).toDate(),onSelect:g,_css7:1*constants.GU})),React__default.default.createElement(_StyledDiv3,{_css8:2.25*constants.GU,_css9:P?"":"\n                    max-width: 247px;\n                    margin-left: auto;\n                  "},React__default.default.createElement(Button.default,{onClick:v,size:"small",wide:!0},"Reset"),React__default.default.createElement(_StyledButton,{disabled:!f||!j,mode:"strong",onClick:b,size:"small",wide:!0,_css10:1.5*constants.GU},"Apply")))))}DateRangePicker.propTypes={endDate:index.propTypes.instanceOf(Date),format:index.propTypes.string,onChange:index.propTypes.func,startDate:index.propTypes.instanceOf(Date)},DateRangePicker.defaultProps={format:"MM/DD/YYYY",onChange:function(){}},exports.default=DateRangePicker;